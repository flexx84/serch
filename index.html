<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‡¼í•‘ëª° ê±°ë˜ë‚´ì—­ ì¡°íšŒ</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Babel ê²½ê³  ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
        console.warn = function() {};
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f9fafb;
        }
        .min-h-screen { min-height: 100vh; }
        .bg-gray-50 { background-color: #f9fafb; }
        .bg-white { background-color: #ffffff; }
        .bg-blue-50 { background-color: #eff6ff; }
        .bg-green-50 { background-color: #f0fdf4; }
        .bg-red-50 { background-color: #fef2f2; }
        .bg-orange-50 { background-color: #fff7ed; }
        .bg-gray-100 { background-color: #f3f4f6; }
        .text-gray-900 { color: #111827; }
        .text-gray-600 { color: #4b5563; }
        .text-gray-500 { color: #6b7280; }
        .text-gray-400 { color: #9ca3af; }
        .text-blue-600 { color: #2563eb; }
        .text-blue-700 { color: #1d4ed8; }
        .text-blue-800 { color: #1e40af; }
        .text-green-600 { color: #16a34a; }
        .text-green-700 { color: #15803d; }
        .text-green-800 { color: #166534; }
        .text-red-600 { color: #dc2626; }
        .text-red-700 { color: #b91c1c; }
        .text-red-800 { color: #991b1b; }
        .text-orange-600 { color: #ea580c; }
        .text-white { color: #ffffff; }
        .border { border-width: 1px; }
        .border-gray-200 { border-color: #e5e7eb; }
        .border-blue-200 { border-color: #bfdbfe; }
        .border-green-200 { border-color: #bbf7d0; }
        .border-red-200 { border-color: #fecaca; }
        .border-orange-200 { border-color: #fed7aa; }
        .border-gray-100 { border-color: #f3f4f6; }
        .border-gray-300 { border-color: #d1d5db; }
        .border-b { border-bottom-width: 1px; }
        .border-t { border-top-width: 1px; }
        .border-2 { border-width: 2px; }
        .border-dashed { border-style: dashed; }
        .rounded { border-radius: 0.25rem; }
        .rounded-lg { border-radius: 0.5rem; }
        .rounded-xl { border-radius: 0.75rem; }
        .rounded-full { border-radius: 9999px; }
        .p-3 { padding: 0.75rem; }
        .p-4 { padding: 1rem; }
        .p-6 { padding: 1.5rem; }
        .p-8 { padding: 2rem; }
        .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .py-12 { padding-top: 3rem; padding-bottom: 3rem; }
        .pl-10 { padding-left: 2.5rem; }
        .pr-3 { padding-right: 0.75rem; }
        .pr-4 { padding-right: 1rem; }
        .pt-2 { padding-top: 0.5rem; }
        .mb-1 { margin-bottom: 0.25rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mt-1 { margin-top: 0.25rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .flex { display: flex; }
        .inline-flex { display: inline-flex; }
        .grid { display: grid; }
        .hidden { display: none; }
        .items-center { align-items: center; }
        .items-start { align-items: flex-start; }
        .justify-between { justify-content: space-between; }
        .justify-center { justify-content: center; }
        .gap-1 { gap: 0.25rem; }
        .gap-2 { gap: 0.5rem; }
        .gap-3 { gap: 0.75rem; }
        .space-x-2 > * + * { margin-left: 0.5rem; }
        .space-y-1 > * + * { margin-top: 0.25rem; }
        .space-y-2 > * + * { margin-top: 0.5rem; }
        .space-y-3 > * + * { margin-top: 0.75rem; }
        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .flex-1 { flex: 1 1 0%; }
        .w-4 { width: 1rem; }
        .w-5 { width: 1.25rem; }
        .w-8 { width: 2rem; }
        .w-12 { width: 3rem; }
        .w-16 { width: 4rem; }
        .w-full { width: 100%; }
        .h-4 { height: 1rem; }
        .h-5 { height: 1.25rem; }
        .h-8 { height: 2rem; }
        .h-12 { height: 3rem; }
        .h-16 { height: 4rem; }
        .h-20 { height: 5rem; }
        .max-w-md { max-width: 28rem; }
        .text-xs { font-size: 0.75rem; line-height: 1rem; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
        .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
        .text-2xl { font-size: 1.5rem; line-height: 2rem; }
        .font-medium { font-weight: 500; }
        .font-semibold { font-weight: 600; }
        .font-bold { font-weight: 700; }
        .font-mono { font-family: ui-monospace, SFMono-Regular, "SF Mono", Consolas, "Liberation Mono", Menlo, monospace; }
        .leading-5 { line-height: 1.25rem; }
        .leading-relaxed { line-height: 1.625; }
        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .text-right { text-align: right; }
        .cursor-pointer { cursor: pointer; }
        .sticky { position: sticky; }
        .fixed { position: fixed; }
        .absolute { position: absolute; }
        .relative { position: relative; }
        .top-0 { top: 0px; }
        .top-1\/2 { top: 50%; }
        .left-3 { left: 0.75rem; }
        .inset-0 { top: 0px; right: 0px; bottom: 0px; left: 0px; }
        .z-10 { z-index: 10; }
        .z-50 { z-index: 50; }
        .transform { transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }
        .-translate-y-1\/2 { --tw-translate-y: -50%; }
        .transition-transform { transition-property: transform; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
        .rotate-180 { --tw-rotate: 180deg; }
        .shadow-sm { box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); }
        .shadow-lg { box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.05); }
        .overflow-hidden { overflow: hidden; }
        .opacity-50 { opacity: 0.5; }
        .bg-opacity-50 { --tw-bg-opacity: 0.5; }
        .bg-black { background-color: rgb(0 0 0 / var(--tw-bg-opacity, 1)); }
        .bg-blue-500 { background-color: #3b82f6; }
        .bg-green-500 { background-color: #22c55e; }
        .bg-red-500 { background-color: #ef4444; }
        .hover\:text-gray-600:hover { color: #4b5563; }
        .focus\:ring-2:focus { box-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color); }
        .focus\:ring-blue-500:focus { --tw-ring-color: #3b82f6; }
        .focus\:border-transparent:focus { border-color: transparent; }
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .border-b-2 { border-bottom-width: 2px; }
        .border-blue-600 { border-color: #2563eb; }
        input, button {
            outline: none;
        }
        input:focus {
            ring: 2px solid #3b82f6;
        }
    </style>
</head>
<body>
    <div id="root">
        <div style="display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #f9fafb;">
            <div style="text-align: center;">
                <div style="font-size: 1.5rem; font-weight: bold; color: #374151; margin-bottom: 1rem;">ë¡œë”© ì¤‘...</div>
                <div style="color: #6b7280;">í˜ì´ì§€ë¥¼ ì¤€ë¹„í•˜ê³  ìˆìŠµë‹ˆë‹¤</div>
            </div>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // ì•„ì´ì½˜ ì»´í¬ë„ŒíŠ¸ë“¤
        const SearchIcon = () => (
            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
        );

        const ChevronDownIcon = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="m19 9-7 7-7-7" />
            </svg>
        );

        const CalendarIcon = () => (
            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
            </svg>
        );

        const EyeIcon = () => (
            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
        );

        const UploadIcon = ({ className = "w-12 h-12 text-gray-400 mx-auto mb-3" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
            </svg>
        );

        const FileSpreadsheetIcon = () => (
            <svg className="w-16 h-16 text-blue-600 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
        );

        const CheckCircleIcon = () => (
            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        const XCircleIcon = () => (
            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        const AlertTriangleIcon = () => (
            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z" />
            </svg>
        );

        const RotateCcwIcon = () => (
            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
        );

        const TransactionViewer = () => {
            const [transactions, setTransactions] = useState([]);
            const [filteredTransactions, setFilteredTransactions] = useState([]);
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedFilter, setSelectedFilter] = useState('all');
            const [selectedCard, setSelectedCard] = useState(null);
            const [startDate, setStartDate] = useState('');
            const [endDate, setEndDate] = useState('');
            const [showDateFilter, setShowDateFilter] = useState(false);
            const [showUpload, setShowUpload] = useState(false);
            const [isLoading, setIsLoading] = useState(false);
            const [isLoadingDefault, setIsLoadingDefault] = useState(true);
            const [dataLoadedFromFile, setDataLoadedFromFile] = useState(false);  // data.xlsxë¡œ ë¡œë“œë˜ì—ˆëŠ”ì§€ ì¶”ì 

            // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ data.xlsx íŒŒì¼ ë¡œë“œ
            useEffect(() => {
                loadDefaultData();
            }, []);

            const loadDefaultData = async () => {
                setIsLoadingDefault(true);
                try {
                    console.log('data.xlsx íŒŒì¼ ë¡œë“œ ì‹œë„ ì¤‘...');
                    
                    // GitHubì— ì—…ë¡œë“œëœ data.xlsx íŒŒì¼ì„ ìë™ ë¡œë“œ
                    const response = await fetch('./data.xlsx');
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤`);
                    }
                    
                    const arrayBuffer = await response.arrayBuffer();
                    const workbook = XLSX.read(arrayBuffer);
                    const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
                    
                    console.log('ì—‘ì…€ íŒŒì¼ ë¡œë“œ ì„±ê³µ:', jsonData.length, 'í–‰');
                    
                    // í—¤ë” ì œê±°í•˜ê³  ì‹¤ì œ ë°ì´í„°ë§Œ ì¶”ì¶œ
                    const dataRows = jsonData.slice(1)
                        .filter(row => row[0] && row[0] !== '')
                        .map(row => ({
                            no: row[0],
                            paymentDate: row[1],
                            cancelDate: row[2],
                            bank: row[3],
                            approvalNumber: row[4],
                            productName: row[5],
                            amount: parseInt(row[6]) || 0,
                            cardNumber: row[7],
                            phone: row[8],
                            status: row[9],
                            customerId: row[10]
                        }));
                    
                    console.log('ì²˜ë¦¬ëœ ë°ì´í„°:', dataRows.length, 'ê±´');
                    
                    setTransactions(dataRows);
                    setFilteredTransactions(dataRows);
                    setDataLoadedFromFile(true);  // data.xlsxë¡œ ë¡œë“œ ì„±ê³µ í‘œì‹œ
                    
                } catch (error) {
                    console.log('data.xlsx íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨:', error.message);
                    console.log('ì—…ë¡œë“œ ëª¨ë“œë¡œ ì „í™˜í•©ë‹ˆë‹¤');
                    setShowUpload(true);
                } finally {
                    setIsLoadingDefault(false);
                }
            };

            const handleFileUpload = async (event) => {
                const file = event.target.files[0];
                if (!file) return;

                setIsLoading(true);
                try {
                    const arrayBuffer = await file.arrayBuffer();
                    const workbook = XLSX.read(arrayBuffer);
                    const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
                    
                    console.log('ë¡œë“œëœ ë°ì´í„°:', jsonData.length, 'í–‰');
                    
                    // í—¤ë” ì œê±°í•˜ê³  ì‹¤ì œ ë°ì´í„°ë§Œ ì¶”ì¶œ
                    const dataRows = jsonData.slice(1)
                        .filter(row => row[0] && row[0] !== '') // NOê°€ ìˆëŠ” í–‰ë§Œ
                        .map(row => ({
                            no: row[0],
                            paymentDate: row[1],
                            cancelDate: row[2],
                            bank: row[3],
                            approvalNumber: row[4],
                            productName: row[5],
                            amount: parseInt(row[6]) || 0,
                            cardNumber: row[7],
                            phone: row[8],
                            status: row[9],
                            customerId: row[10]
                        }));
                    
                    console.log('ì²˜ë¦¬ëœ ë°ì´í„°:', dataRows.length, 'ê±´');
                    
                    setTransactions(dataRows);
                    setFilteredTransactions(dataRows);
                    setShowUpload(false);
                } catch (error) {
                    console.error('íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨:', error);
                    alert('íŒŒì¼ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì˜¬ë°”ë¥¸ ì—‘ì…€ íŒŒì¼ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.');
                } finally {
                    setIsLoading(false);
                }
            };

            useEffect(() => {
                applyFilters();
            }, [searchTerm, selectedFilter, startDate, endDate, transactions]);

            const applyFilters = () => {
                let filtered = [...transactions];

                // ê²€ìƒ‰ í•„í„°
                if (searchTerm) {
                    filtered = filtered.filter(t => 
                        t.productName?.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        t.customerId?.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        t.approvalNumber?.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        t.phone?.includes(searchTerm)
                    );
                }

                // ìƒíƒœ í•„í„°
                if (selectedFilter === 'approved') {
                    filtered = filtered.filter(t => t.status === 'ìŠ¹ì¸');
                } else if (selectedFilter === 'cancelled') {
                    filtered = filtered.filter(t => t.status === 'ì „ì·¨ì†Œ' || t.status === 'í›„ì·¨ì†Œ');
                }

                // ë‚ ì§œ í•„í„°
                if (startDate || endDate) {
                    filtered = filtered.filter(t => {
                        if (!t.paymentDate) return false;
                        const paymentDate = String(t.paymentDate).substr(0, 8); // YYYYMMDD
                        const start = startDate.replace(/-/g, '');
                        const end = endDate.replace(/-/g, '');
                        
                        if (startDate && endDate) {
                            return paymentDate >= start && paymentDate <= end;
                        } else if (startDate) {
                            return paymentDate >= start;
                        } else if (endDate) {
                            return paymentDate <= end;
                        }
                        return true;
                    });
                }

                setFilteredTransactions(filtered);
            };

            const formatDate = (dateStr) => {
                if (!dateStr) return '-';
                const str = String(dateStr);
                if (str.length < 8) return str;
                const year = str.substr(0, 4);
                const month = str.substr(4, 2);
                const day = str.substr(6, 2);
                const hour = str.substr(8, 2) || '00';
                const minute = str.substr(10, 2) || '00';
                return `${year}.${month}.${day} ${hour}:${minute}`;
            };

            const formatAmount = (amount) => {
                return new Intl.NumberFormat('ko-KR').format(amount) + 'ì›';
            };

            const getStatusColor = (status) => {
                switch(status) {
                    case 'ìŠ¹ì¸': return 'text-green-600 bg-green-50 border-green-200';
                    case 'ì „ì·¨ì†Œ': return 'text-red-600 bg-red-50 border-red-200';
                    case 'í›„ì·¨ì†Œ': return 'text-orange-600 bg-orange-50 border-orange-200';
                    default: return 'text-gray-600 bg-gray-50 border-gray-200';
                }
            };

            const getStatusIcon = (status) => {
                switch(status) {
                    case 'ìŠ¹ì¸': return <CheckCircleIcon />;
                    case 'ì „ì·¨ì†Œ': return <XCircleIcon />;
                    case 'í›„ì·¨ì†Œ': return <AlertTriangleIcon />;
                    default: return <CheckCircleIcon />;
                }
            };

            const resetFilters = () => {
                setSearchTerm('');
                setSelectedFilter('all');
                setStartDate('');
                setEndDate('');
            };

            const getTotalStats = () => {
                const approved = transactions.filter(t => t.status === 'ìŠ¹ì¸');
                const cancelled = transactions.filter(t => t.status === 'ì „ì·¨ì†Œ' || t.status === 'í›„ì·¨ì†Œ');
                const approvedAmount = approved.reduce((sum, t) => sum + (t.amount || 0), 0);
                const cancelledAmount = cancelled.reduce((sum, t) => sum + (t.amount || 0), 0);
                
                return { 
                    approved: approved.length, 
                    cancelled: cancelled.length, 
                    approvedAmount, 
                    cancelledAmount,
                    total: transactions.length,
                    totalAmount: approvedAmount + cancelledAmount
                };
            };

            const stats = getTotalStats();

            // ë¡œë”© ì¤‘ì´ê±°ë‚˜ ì—…ë¡œë“œ í™”ë©´
            if (isLoadingDefault) {
                return (
                    <div className="min-h-screen bg-gray-50 flex items-center justify-center p-4">
                        <div className="bg-white rounded-xl shadow-lg p-8 max-w-md w-full text-center">
                            <div className="mb-6">
                                <FileSpreadsheetIcon />
                                <h1 className="text-2xl font-bold text-gray-900 mb-2">ì‡¼í•‘ëª° ê±°ë˜ë‚´ì—­</h1>
                                <p className="text-gray-600">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
                            </div>
                            <div className="flex justify-center">
                                <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
                            </div>
                        </div>
                    </div>
                );
            }

            if (showUpload && transactions.length === 0) {
                return (
                    <div className="min-h-screen bg-gray-50 flex items-center justify-center p-4">
                        <div className="bg-white rounded-xl shadow-lg p-8 max-w-md w-full text-center">
                            <div className="mb-6">
                                <FileSpreadsheetIcon />
                                <h1 className="text-2xl font-bold text-gray-900 mb-2">ì‡¼í•‘ëª° ê±°ë˜ë‚´ì—­</h1>
                                <p className="text-gray-600">data.xlsx íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                                <p className="text-sm text-gray-500 mt-2">GitHub ë¦¬í¬ì§€í† ë¦¬ì— data.xlsx íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê±°ë‚˜<br/>ì§ì ‘ ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.</p>
                            </div>
                            
                            <div className="border-2 border-dashed border-gray-300 rounded-lg p-6 mb-4">
                                <UploadIcon />
                                <input
                                    type="file"
                                    accept=".xlsx,.xls"
                                    onChange={handleFileUpload}
                                    className="hidden"
                                    id="file-upload"
                                    disabled={isLoading}
                                />
                                <label
                                    htmlFor="file-upload"
                                    className={`cursor-pointer ${isLoading ? 'opacity-50' : ''}`}
                                >
                                    <div className="text-blue-600 font-medium mb-1">
                                        {isLoading ? 'ì²˜ë¦¬ ì¤‘...' : 'íŒŒì¼ ì„ íƒí•˜ê¸°'}
                                    </div>
                                    <div className="text-sm text-gray-500">
                                        .xlsx, .xls íŒŒì¼ë§Œ ì§€ì›
                                    </div>
                                </label>
                            </div>
                            
                            <div className="text-xs text-gray-500 text-left bg-gray-50 p-3 rounded">
                                <strong>í•„ìš”í•œ ì»¬ëŸ¼:</strong><br/>
                                NO, ê²°ì œì¼ì, ì·¨ì†Œì¼ì, ê¸ˆìœµì‚¬, ìŠ¹ì¸ë²ˆí˜¸, ìƒí’ˆëª…, ê²°ì œê¸ˆì•¡, ì¹´ë“œ/ê³„ì¢Œë²ˆí˜¸, ì „í™”ë²ˆí˜¸, ìƒíƒœ, êµ¬ë§¤ì(ê³ ê°ID)
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* í—¤ë” */}
                    <div className="bg-white shadow-sm border-b sticky top-0 z-10">
                        <div className="px-4 py-4">
                            <div className="flex justify-between items-center">
                                <div>
                                    <h1 className="text-xl font-bold text-gray-900">ì‡¼í•‘ëª° ê±°ë˜ë‚´ì—­</h1>
                                    <p className="text-sm text-gray-500">ì´ {filteredTransactions.length}ê±´</p>
                                </div>
                                <div className="flex gap-2">
                                    <button
                                        onClick={() => setShowDateFilter(!showDateFilter)}
                                        className="flex items-center gap-1 px-3 py-1 bg-blue-500 text-white rounded-lg text-sm"
                                    >
                                        <CalendarIcon />
                                        ë‚ ì§œì¡°íšŒ
                                    </button>
                                    {/* data.xlsxë¡œ ë¡œë“œë˜ì§€ ì•Šì€ ê²½ìš°ì—ë§Œ íŒŒì¼ì—…ë¡œë“œ ë²„íŠ¼ í‘œì‹œ */}
                                    {!dataLoadedFromFile && (
                                        <button
                                            onClick={() => setShowUpload(true)}
                                            className="flex items-center gap-1 px-3 py-1 bg-green-500 text-white rounded-lg text-sm"
                                        >
                                            <UploadIcon className="w-4 h-4" />
                                            íŒŒì¼ì—…ë¡œë“œ
                                        </button>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* í†µê³„ ì¹´ë“œ */}
                    <div className="p-4">
                        <div className="grid grid-cols-3 gap-3 mb-4">
                            <div className="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                <div className="flex items-center gap-2 mb-1">
                                    <EyeIcon />
                                    <span className="text-sm font-medium text-blue-700">ì „ì²´</span>
                                </div>
                                <p className="text-lg font-bold text-blue-800">{stats.total}ê±´</p>
                                <p className="text-xs text-blue-600">{formatAmount(stats.totalAmount)}</p>
                            </div>
                            <div className="bg-green-50 border border-green-200 rounded-lg p-3">
                                <div className="flex items-center gap-2 mb-1">
                                    <CheckCircleIcon />
                                    <span className="text-sm font-medium text-green-700">ìŠ¹ì¸</span>
                                </div>
                                <p className="text-lg font-bold text-green-800">{stats.approved}ê±´</p>
                                <p className="text-xs text-green-600">{formatAmount(stats.approvedAmount)}</p>
                            </div>
                            <div className="bg-red-50 border border-red-200 rounded-lg p-3">
                                <div className="flex items-center gap-2 mb-1">
                                    <XCircleIcon />
                                    <span className="text-sm font-medium text-red-700">ì·¨ì†Œ</span>
                                </div>
                                <p className="text-lg font-bold text-red-800">{stats.cancelled}ê±´</p>
                                <p className="text-xs text-red-600">{formatAmount(stats.cancelledAmount)}</p>
                            </div>
                        </div>
                    </div>

                    {/* íŒŒì¼ ì—…ë¡œë“œ ëª¨ë‹¬ */}
                    {showUpload && transactions.length > 0 && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                            <div className="bg-white rounded-xl p-6 max-w-md w-full">
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="text-lg font-bold">ìƒˆ íŒŒì¼ ì—…ë¡œë“œ</h3>
                                    <button
                                        onClick={() => setShowUpload(false)}
                                        className="text-gray-400 hover:text-gray-600"
                                    >
                                        âœ•
                                    </button>
                                </div>
                                <div className="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center">
                                    <UploadIcon />
                                    <input
                                        type="file"
                                        accept=".xlsx,.xls"
                                        onChange={handleFileUpload}
                                        className="hidden"
                                        id="modal-file-upload"
                                        disabled={isLoading}
                                    />
                                    <label
                                        htmlFor="modal-file-upload"
                                        className={`cursor-pointer ${isLoading ? 'opacity-50' : ''}`}
                                    >
                                        <div className="text-blue-600 font-medium mb-1">
                                            {isLoading ? 'ì²˜ë¦¬ ì¤‘...' : 'íŒŒì¼ ì„ íƒí•˜ê¸°'}
                                        </div>
                                        <div className="text-sm text-gray-500">
                                            ìƒˆë¡œìš´ ì—‘ì…€ íŒŒì¼ë¡œ êµì²´ë©ë‹ˆë‹¤
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* ë‚ ì§œ í•„í„° */}
                    {showDateFilter && (
                        <div className="bg-white border-b p-4 space-y-3">
                            <div className="flex items-center justify-between">
                                <h3 className="font-medium text-gray-900">ê¸°ê°„ ì¡°íšŒ</h3>
                                <button
                                    onClick={() => setShowDateFilter(false)}
                                    className="text-gray-400 hover:text-gray-600"
                                >
                                    âœ•
                                </button>
                            </div>
                            <div className="grid grid-cols-2 gap-3">
                                <div>
                                    <label className="block text-sm text-gray-600 mb-1">ì‹œì‘ì¼</label>
                                    <input
                                        type="date"
                                        value={startDate}
                                        onChange={(e) => setStartDate(e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-200 rounded-lg"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm text-gray-600 mb-1">ì¢…ë£Œì¼</label>
                                    <input
                                        type="date"
                                        value={endDate}
                                        onChange={(e) => setEndDate(e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-200 rounded-lg"
                                    />
                                </div>
                            </div>
                            <button
                                onClick={resetFilters}
                                className="w-full flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-600 rounded-lg"
                            >
                                <RotateCcwIcon />
                                í•„í„° ì´ˆê¸°í™”
                            </button>
                        </div>
                    )}

                    {/* ê²€ìƒ‰ ë° í•„í„° */}
                    <div className="bg-white border-b p-4 space-y-3">
                        {/* ê²€ìƒ‰ë°” */}
                        <div className="relative">
                            <div className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                                <SearchIcon />
                            </div>
                            <input
                                type="text"
                                placeholder="ìƒí’ˆëª…, ê³ ê°ID, ìŠ¹ì¸ë²ˆí˜¸, ì „í™”ë²ˆí˜¸ ê²€ìƒ‰..."
                                className="w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg"
                                value={searchTerm}
                                onChange={(e) => setSearchTerm(e.target.value)}
                            />
                        </div>

                        {/* í•„í„° ë²„íŠ¼ */}
                        <div className="flex space-x-2">
                            <button
                                onClick={() => setSelectedFilter('all')}
                                className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium ${
                                    selectedFilter === 'all' 
                                        ? 'bg-blue-500 text-white' 
                                        : 'bg-gray-100 text-gray-600'
                                }`}
                            >
                                <EyeIcon />
                                ì „ì²´
                            </button>
                            <button
                                onClick={() => setSelectedFilter('approved')}
                                className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium ${
                                    selectedFilter === 'approved' 
                                        ? 'bg-green-500 text-white' 
                                        : 'bg-gray-100 text-gray-600'
                                }`}
                            >
                                <CheckCircleIcon />
                                ìŠ¹ì¸
                            </button>
                            <button
                                onClick={() => setSelectedFilter('cancelled')}
                                className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium ${
                                    selectedFilter === 'cancelled' 
                                        ? 'bg-red-500 text-white' 
                                        : 'bg-gray-100 text-gray-600'
                                }`}
                            >
                                <XCircleIcon />
                                ì·¨ì†Œ
                            </button>
                        </div>
                    </div>

                    {/* ê±°ë˜ ëª©ë¡ */}
                    <div className="p-4 space-y-3">
                        {filteredTransactions.map((transaction, index) => (
                            <div
                                key={`${transaction.no}-${index}`}
                                className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"
                            >
                                {/* ë©”ì¸ ì¹´ë“œ */}
                                <div
                                    className="p-4 cursor-pointer"
                                    onClick={() => setSelectedCard(selectedCard === index ? null : index)}
                                >
                                    <div className="flex justify-between items-start mb-3">
                                        <div className="flex-1 pr-3">
                                            <div className="flex items-start justify-between mb-2">
                                                <span className="text-xs font-medium text-gray-500 bg-gray-100 px-2 py-1 rounded">
                                                    #{transaction.no}
                                                </span>
                                                <div className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium border ${getStatusColor(transaction.status)}`}>
                                                    {getStatusIcon(transaction.status)}
                                                    {transaction.status}
                                                </div>
                                            </div>
                                            <h3 className="font-semibold text-gray-900 line-clamp-2 leading-5 mb-2">
                                                {transaction.productName}
                                            </h3>
                                            <div className="space-y-1">
                                                <p className="text-sm text-gray-600">
                                                    ğŸ“… {formatDate(transaction.paymentDate)}
                                                </p>
                                                <p className="text-sm text-gray-600">
                                                    ğŸ‘¤ {transaction.customerId}
                                                </p>
                                            </div>
                                        </div>
                                        <div className="text-right">
                                            <p className="text-xl font-bold text-gray-900 mb-1">
                                                {formatAmount(transaction.amount)}
                                            </p>
                                            <p className="text-sm text-gray-500">{transaction.bank}</p>
                                        </div>
                                    </div>

                                    {/* í™•ì¥ í‘œì‹œ */}
                                    <div className="flex justify-center pt-2 border-t border-gray-100">
                                        <ChevronDownIcon 
                                            className={`w-5 h-5 text-gray-400 transition-transform ${
                                                selectedCard === index ? 'rotate-180' : ''
                                            }`}
                                        />
                                    </div>
                                </div>

                                {/* ìƒì„¸ ì •ë³´ (í™•ì¥) */}
                                {selectedCard === index && (
                                    <div className="border-t border-gray-100 bg-gray-50 p-4">
                                        <h4 className="font-semibold text-gray-900 mb-3 flex items-center gap-2">
                                            <EyeIcon />
                                            ìƒì„¸ ì •ë³´
                                        </h4>
                                        
                                        <div className="space-y-3">
                                            {/* ê¸°ë³¸ ì •ë³´ */}
                                            <div className="bg-white rounded-lg p-3 space-y-2">
                                                <div className="grid grid-cols-2 gap-3 text-sm">
                                                    <div>
                                                        <span className="block text-gray-500 font-medium">ê±°ë˜ë²ˆí˜¸</span>
                                                        <p className="font-semibold text-gray-900">#{transaction.no}</p>
                                                    </div>
                                                    <div>
                                                        <span className="block text-gray-500 font-medium">ìŠ¹ì¸ë²ˆí˜¸</span>
                                                        <p className="font-mono text-gray-900">{transaction.approvalNumber}</p>
                                                    </div>
                                                    <div>
                                                        <span className="block text-gray-500 font-medium">ê¸ˆìœµì‚¬</span>
                                                        <p className="text-gray-900">{transaction.bank}</p>
                                                    </div>
                                                    <div>
                                                        <span className="block text-gray-500 font-medium">ìƒíƒœ</span>
                                                        <div className={`inline-flex items-center gap-1 px-2 py-1 rounded text-xs ${getStatusColor(transaction.status)}`}>
                                                            {getStatusIcon(transaction.status)}
                                                            {transaction.status}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* ê²°ì œ ì •ë³´ */}
                                            <div className="bg-white rounded-lg p-3 space-y-2">
                                                <h5 className="font-medium text-gray-900 mb-2">ê²°ì œ ì •ë³´</h5>
                                                <div className="space-y-2 text-sm">
                                                    <div>
                                                        <span className="block text-gray-500 font-medium">ì¹´ë“œ/ê³„ì¢Œë²ˆí˜¸</span>
                                                        <p className="font-mono text-gray-900">{transaction.cardNumber}</p>
                                                    </div>
                                                    <div>
                                                        <span className="block text-gray-500 font-medium">ê²°ì œê¸ˆì•¡</span>
                                                        <p className="text-lg font-bold text-blue-600">{formatAmount(transaction.amount)}</p>
                                                    </div>
                                                    <div>
                                                        <span className="block text-gray-500 font-medium">ê²°ì œì¼ì‹œ</span>
                                                        <p className="text-gray-900">{formatDate(transaction.paymentDate)}</p>
                                                    </div>
                                                    {transaction.cancelDate && (
                                                        <div>
                                                            <span className="block text-red-600 font-medium">ì·¨ì†Œì¼ì‹œ</span>
                                                            <p className="text-red-600">{formatDate(transaction.cancelDate)}</p>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>

                                            {/* ê³ ê° ì •ë³´ */}
                                            <div className="bg-white rounded-lg p-3 space-y-2">
                                                <h5 className="font-medium text-gray-900 mb-2">ê³ ê° ì •ë³´</h5>
                                                <div className="grid grid-cols-1 gap-2 text-sm">
                                                    <div>
                                                        <span className="block text-gray-500 font-medium">ê³ ê°ID</span>
                                                        <p className="text-gray-900">{transaction.customerId}</p>
                                                    </div>
                                                    <div>
                                                        <span className="block text-gray-500 font-medium">ì—°ë½ì²˜</span>
                                                        <p className="text-gray-900">{transaction.phone}</p>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* ìƒí’ˆ ì •ë³´ */}
                                            <div className="bg-white rounded-lg p-3">
                                                <h5 className="font-medium text-gray-900 mb-2">ìƒí’ˆ ì •ë³´</h5>
                                                <p className="text-gray-900 leading-relaxed">{transaction.productName}</p>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        ))}

                        {filteredTransactions.length === 0 && transactions.length > 0 && (
                            <div className="text-center py-12">
                                <div className="text-gray-400 mb-3 flex justify-center">
                                    <SearchIcon />
                                </div>
                                <p className="text-gray-500 text-lg font-medium">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</p>
                                <p className="text-gray-400 text-sm mt-1">ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë‚˜ í•„í„°ë¥¼ ì‹œë„í•´ë³´ì„¸ìš”</p>
                            </div>
                        )}
                    </div>

                    {/* í•˜ë‹¨ ì—¬ë°± */}
                    <div className="h-20"></div>
                </div>
            );
        };

        // React ì»´í¬ë„ŒíŠ¸ ë Œë”ë§
        setTimeout(() => {
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(React.createElement(TransactionViewer));
        }, 100);
    </script>
</body>
</html>
